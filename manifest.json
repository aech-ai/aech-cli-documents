{
    "name": "documents",
    "type": "cli",
    "description": "Normalize documents for downstream processing. The CLI accepts PDFs, most Office formats, and already-digitized images. The `convert` command rasterizes each page into numbered PNG files (auto-converting Office files to PDF via LibreOffice first). The `convert-to-markdown` command runs MarkItDown to export clean Markdown, auto-upgrading legacy Office formats to DOCX as needed. Inputs are local file paths and an output directory, making it safe for sandboxed execution. Example: `aech-cli-documents convert briefs/proposal.docx --output-dir work/proposal_images`.",
    "command": "aech-cli-documents",
    "actions": [
        {
            "name": "convert",
            "description": "Render a document to page-by-page PNG images. Office files are converted to PDF first, PDFs are split via `pdf2image`, and standalone images are normalized to PNG. Outputs land in `output_dir` as `page_001.png`, `page_002.png`, etc., and the command prints a JSON list of the file paths. Example: `convert deck.pptx --output-dir build/deck_images`.",
            "parameters": [
                {"name": "input_path", "type": "argument", "required": true},
                {"name": "output_dir", "type": "option", "required": true}
            ]
        },
        {
            "name": "convert-to-markdown",
            "description": "Convert supported documents to Markdown text via MarkItDown. Legacy Office formats are first converted to DOCX using LibreOffice so the Markdown mirrors the latest layout. The resulting `<stem>.md` file is saved in `output_dir` and the command returns its path as JSON. Example: `convert-to-markdown reports/notes.pdf --output-dir build/md`.",
            "parameters": [
                {"name": "input_path", "type": "argument", "required": true},
                {"name": "output_dir", "type": "option", "required": true}
            ]
        },
        {
            "name": "convert-markdown",
            "description": "Use Pandoc to render Markdown into polished Office/PDF outputs. Formats default to DOCX and PDF for consistent styling, but you can request multiple targets via repeated `--format` options. Example: `convert-markdown README.md --output-dir build/pandoc --format docx --format pptx`.",
            "parameters": [
                {"name": "input_path", "type": "argument", "required": true},
                {"name": "output_dir", "type": "option", "required": true},
                {"name": "format", "type": "option", "required": false}
            ]
        }
    ],
    "available_in_sandbox": true
}
